!pip install transformers torch spacy
!python -m spacy download en_core_web_sm
import spacy
from transformers import pipeline
# SpaCy model for NER
nlp = spacy.load("en_core_web_sm")

# Zero-shot classifier for relationship classification
relation_classifier = pipeline(
    "zero-shot-classification",
    model="facebook/bart-large-mnli"
)
text = "Sundar Pichai is the CEO of Google and works in the United States."
doc = nlp(text)

entities = [(ent.text, ent.label_) for ent in doc.ents]
print("Named Entities:")
print(entities)
[('Sundar Pichai', 'PERSON'), ('Google', 'ORG'), ('United States', 'GPE')]
entity_pairs = []

for i in range(len(doc.ents)):
    for j in range(i + 1, len(doc.ents)):
        entity_pairs.append((doc.ents[i].text, doc.ents[j].text))

print("\nEntity Pairs:")
print(entity_pairs)
candidate_relations = [
    "works for",
    "CEO of",
    "located in",
    "lives in",
    "founded by"
]

for e1, e2 in entity_pairs:
    sentence = f"{e1} and {e2} relationship"
    
    result = relation_classifier(
        sentence,
        candidate_labels=candidate_relations
    )
    
    print(f"\nEntity Pair: ({e1}, {e2})")
    print("Predicted Relation:", result["labels"][0])
    print("Confidence:", round(result["scores"][0], 3))
